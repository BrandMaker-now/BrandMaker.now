<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>世界一周 窓の旅</title>
    <style>
        body { background-color: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        /* 飛行機の窓枠 */
        .window-frame {
            position: relative; width: 320px; height: 480px; background-color: #000;
            border: 18px solid #dcdcdc; border-radius: 120px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3), inset 0 0 20px rgba(0,0,0,0.8);
            overflow: hidden;
        }
        /* 映像を中央に配置して拡大 */
        #player-container { position: absolute; top: 50%; left: 50%; width: 500%; height: 100%; transform: translate(-50%, -50%); }
        #player { width: 100%; height: 100%; pointer-events: none; }
        
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: black; opacity: 1; transition: opacity 1.5s ease; z-index: 10; pointer-events: none; }
        .info-panel { position: absolute; top: 40px; width: 100%; text-align: center; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.8); z-index: 20; font-size: 14px; }
        .timer-bar-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 4px; background: rgba(255,255,255,0.2); z-index: 20; }
        #timer-bar { width: 0%; height: 100%; background: #fff; }

        /* スタート画面 */
        #start-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
        .btn { background: white; color: black; border: none; padding: 15px 30px; margin: 10px; border-radius: 30px; cursor: pointer; font-size: 16px; font-weight: bold; display: none; } /* 初期は非表示 */
        #loading-text { font-size: 14px; color: #888; }
    </style>
</head>
<body>

    <div id="start-screen">
        <h2 id="msg">航空機を準備中...</h2>
        <div id="loading-text">システムを読み込んでいます</div>
        <button id="btn-sound" class="btn" onclick="startApp(true)">音ありで出発</button>
        <button id="btn-mute" class="btn" onclick="startApp(false)">静かに出発</button>
    </div>

    <div class="window-frame">
        <div id="overlay"></div>
        <div class="info-panel">
            <div id="location-name">READY</div>
            <div id="local-time"></div>
        </div>
        <div id="player-container"><div id="player"></div></div>
        <div class="timer-bar-container"><div id="timer-bar"></div></div>
    </div>

    <script src="https://www.youtube.com"></script>

    <script>
        let player;
        let isMuted = true;
        const videoList = [
            { id: 'rnXIjl_Rzy4', name: 'Shibuya, Tokyo' },
            { id: 'xXZqU5vnEug', name: 'Namibia, Africa' },
            { id: 'Sv9hcJ3k5h4', name: 'Pattaya, Thailand' },
            { id: 'OuCbntsMsWY', name: 'Times Square, NY' },
            { id: 'Yzl9offu5g8', name: 'ISS Space Station' },
            { id: 'zNahac5x0Tw', name: 'Miami Beach, USA' }
        ];

        // YouTube APIの準備ができたら呼ばれる
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                videoId: videoList[0].id,
                playerVars: { 'autoplay': 0, 'controls': 0, 'modestbranding': 1, 'iv_load_policy': 3, 'rel': 0 },
                events: { 'onReady': onPlayerReady }
            });
        }

        function onPlayerReady() {
            // 準備ができたらボタンを表示
            document.getElementById('msg').innerText = "準備が整いました";
            document.getElementById('loading-text').style.display = 'none';
            document.getElementById('btn-sound').style.display = 'block';
            document.getElementById('btn-mute').style.display = 'block';
        }

        function startApp(sound) {
            isMuted = !sound;
            document.getElementById('start-screen').style.display = 'none';
            loadVideo(0);
        }

        function loadVideo(index) {
            const video = videoList[index];
            const overlay = document.getElementById('overlay');
            overlay.style.opacity = 1;

            setTimeout(() => {
                player.loadVideoById(video.id);
                if (isMuted) player.mute(); else player.unMute();
                document.getElementById('location-name').innerText = video.name;
                
                setTimeout(() => {
                    overlay.style.opacity = 0;
                    startTimer(index);
                }, 2000);
            }, 1000);
        }

        function startTimer(currentIndex) {
            let timeLeft = 60;
            const bar = document.getElementById('timer-bar');
            const interval = setInterval(() => {
                timeLeft--;
                bar.style.width = ((60 - timeLeft) / 60 * 100) + '%';
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    let next = (currentIndex + 1) % videoList.length;
                    loadVideo(next);
                }
            }, 1000);
        }

        setInterval(() => {
            document.getElementById('local-time').innerText = new Date().toLocaleTimeString();
        }, 1000);
    </script>
</body>
</html>
